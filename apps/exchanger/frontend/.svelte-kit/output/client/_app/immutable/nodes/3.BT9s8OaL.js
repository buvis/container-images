import{a as n,s as _,f as u,e as U,c as at}from"../chunks/BGC_O7Cu.js";import{i as rt}from"../chunks/CxezgJRR.js";import{p as st,m as b,g as e,l as Z,a as lt,t as p,b as ot,u as f,s,c as r,r as a,d as l,i as Be,e as Ce,f as Me}from"../chunks/D8SkQY_2.js";import{i as y,s as it,a as dt}from"../chunks/CCe7VU-t.js";import{e as ie,i as de,s as nt}from"../chunks/BM-OiPN0.js";import{r as je,s as vt}from"../chunks/1CmXKqvd.js";import{b as Ae}from"../chunks/DupA02UL.js";import{b as Pe}from"../chunks/BKSPwKdY.js";import{s as ct,p as ut}from"../chunks/CdEA5IGF.js";import{p as bt}from"../chunks/ClhLBzmD.js";import{g as pt,a as ft,b as mt,t as _t,p as gt,c as xt,r as ht}from"../chunks/sCxhiejC.js";import{f as ee}from"../chunks/BcTIPSpL.js";var yt=u('<span class="bg-blue-900/50 border border-blue-700 text-blue-200 px-2 py-0.5 rounded text-sm flex items-center gap-1"> <button class="hover:text-white ml-1 text-blue-400 font-bold leading-none">&times;</button></span>'),wt=u('<button class="w-full text-left px-3 py-2 hover:bg-slate-800 text-slate-200 text-sm transition-colors"><div class="flex justify-between items-center"><span class="font-medium"> </span> <span class="text-slate-500 text-xs truncate ml-2"> </span></div></button>'),kt=u('<div class="px-3 py-2 text-slate-500 text-xs border-t border-slate-700"> </div>'),St=u("<!> <!>",1),Bt=u('<div class="px-3 py-2 text-slate-500 text-sm">No matching symbols</div>'),Ct=u('<div class="absolute top-full left-0 w-full bg-slate-900 border border-slate-700 rounded-b mt-1 max-h-60 overflow-y-auto z-50 shadow-xl"><!></div>'),Pt=u('<div class="p-3 bg-green-900/30 text-green-400 rounded border border-green-900"> </div>'),Tt=u('<div class="p-3 bg-red-900/30 text-red-400 rounded border border-red-900"> </div>'),$t=u('<tr class="border-b border-slate-700/50 hover:bg-slate-800/30"><td class="p-2"> </td><td class="p-2"><span> </span></td><td class="p-2 text-sm text-slate-400"> </td></tr>'),Ft=u('<div class="mt-8"><h3 class="text-lg font-medium text-white mb-4">Task Status</h3> <div class="overflow-x-auto"><table class="w-full text-left border-collapse"><thead><tr class="border-b border-slate-600"><th class="p-2 text-slate-400">Name</th><th class="p-2 text-slate-400">Status</th><th class="p-2 text-slate-400">Last Run</th></tr></thead><tbody></tbody></table></div></div>'),Lt=u('<div class="space-y-6"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="space-y-2"><label for="backfill-provider" class="block text-sm font-medium text-slate-300">Provider</label> <select id="backfill-provider" class="w-full bg-slate-800 border border-slate-700 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"><option>CNB</option><option>FCS</option></select></div> <div class="space-y-2"><label for="backfill-length" class="block text-sm font-medium text-slate-300">Length (days)</label> <input id="backfill-length" type="number" min="1" max="3650" class="w-full bg-slate-800 border border-slate-700 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"/></div> <div class="col-span-1 md:col-span-2 space-y-2 relative"><label for="backfill-symbols" class="block text-sm font-medium text-slate-300">Symbols (optional)</label> <div class="w-full bg-slate-800 border border-slate-700 rounded p-2 text-white min-h-[42px] relative focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent"><div class="flex flex-wrap gap-2"><!> <input id="backfill-symbols" type="text" class="bg-transparent border-none outline-none flex-1 min-w-[120px] text-white placeholder-slate-500 text-sm py-1"/></div></div> <!></div></div> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium transition-colors">Trigger Backfill</button> <!> <!> <!></div>'),Nt=u('<div class="p-3 bg-green-900/30 text-green-400 rounded border border-green-900"> </div>'),Rt=u('<div class="p-3 bg-red-900/30 text-red-400 rounded border border-red-900"> </div>'),Dt=u('<div class="space-y-6"><div class="space-y-2 max-w-md"><label for="symbols-provider" class="block text-sm font-medium text-slate-300">Provider</label> <select id="symbols-provider" class="w-full bg-slate-800 border border-slate-700 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"><option>CNB</option><option>FCS</option></select></div> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium transition-colors">Refresh Symbols</button> <!> <!></div>'),Et=u("<option disabled>No backups available</option>"),Mt=u("<option> </option>"),jt=u('<div class="p-3 bg-green-900/30 text-green-400 rounded border border-green-900"> </div>'),At=u('<div class="p-3 bg-red-900/30 text-red-400 rounded border border-red-900"> </div>'),zt=u('<li class="p-2 hover:bg-slate-800 rounded flex justify-between items-center"><span> </span> <span class="text-xs text-slate-500"> </span></li>'),Ot=u('<div class="space-y-6"><div class="bg-slate-800 p-4 rounded border border-slate-700"><h3 class="text-lg font-medium text-white mb-4">Create</h3> <button class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-medium transition-colors">Create New Backup</button></div> <div class="bg-slate-800 p-4 rounded border border-slate-700"><h3 class="text-lg font-medium text-white mb-4">Restore</h3> <div class="flex gap-4"><select class="flex-1 bg-slate-900 border border-slate-700 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"><!></select> <button class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded font-medium transition-colors">Restore</button></div></div> <!> <!> <div class="mt-4"><h3 class="text-sm font-medium text-slate-400 mb-2">Available Backups</h3> <ul class="space-y-1 text-sm text-slate-300"></ul></div></div>'),Ut=u('<div class="bg-slate-950 text-slate-200 p-6"><header class="mb-8"><h1 class="text-3xl font-bold text-white"> </h1></header> <div class="max-w-4xl mx-auto"><div class="bg-slate-900 border border-slate-800 rounded-xl p-6"><!> <!> <!></div></div></div>');function ea(ze,Oe){st(Oe,!1);const _e=()=>dt(bt,"$page",Ue),[Ue,qe]=it(),$=b(),q=b(),ne=b();let L=b("cnb"),ge=b(30),te=b([]),g=b([]),G=b(""),ve=b(!1),ce=b(""),ae=b(""),ue=b([]),be=b("cnb"),pe=b(""),fe=b(""),K=b([]),B=b(null),Q=b(""),H=b("");async function Te(){try{s(ue,await ft())}catch(t){console.error(t)}}async function Ge(){try{s(te,await mt())}catch(t){console.error(t)}}async function $e(){try{const t=await pt();if(e(B)){const i=t.find(m=>m.filename===e(B)?.filename);s(B,i||(t.length>0?t[0]:null))}else t.length>0?s(B,t[0]):s(B,null);s(K,t)}catch(t){console.error(t),s(H,"Failed to load backups")}}function He(t){e(g).find(i=>i.provider_symbol===t.provider_symbol)||s(g,[...e(g),t]),s(G,""),s(ve,!0)}function Ie(t){s(g,e(g).filter(i=>i.provider_symbol!==t.provider_symbol))}async function Je(){s(ce,""),s(ae,"");try{const t=e(g).length>0?e(g).map(m=>m.provider_symbol):void 0,i=await _t(e(L),Number(e(ge)),t);i.scheduled?s(ce,i.message):s(ae,i.message),await Te()}catch(t){s(ae,t.message||"Failed to trigger backfill")}}async function Ke(){s(pe,""),s(fe,"");try{await gt(e(be)),s(pe,"Symbol population triggered successfully")}catch(t){s(fe,t.message||"Failed to populate symbols")}}async function Qe(){s(Q,""),s(H,"");try{const t=await xt();s(Q,`Backup created: ${t.filename}`),await $e()}catch(t){s(H,t.message||"Failed to create backup")}}async function Ve(){if(e(B)){s(Q,""),s(H,"");try{await ht(e(B).timestamp),s(Q,`Restore triggered for ${e(B).filename}`)}catch(t){s(H,t.message||"Failed to restore backup")}}}let xe=b(e(L));Z(()=>_e(),()=>{s($,["backfill","symbols","backups"].includes(_e().url.searchParams.get("tab")||"")?_e().url.searchParams.get("tab"):"backfill")}),Z(()=>e($),()=>{e($)==="backups"&&$e()}),Z(()=>(e($),e(te)),()=>{e($)==="backfill"&&(Te(),e(te).length===0&&Ge())}),Z(()=>(e(te),e(L)),()=>{s(q,e(te).filter(t=>t.provider===e(L)))}),Z(()=>(e(L),e(xe)),()=>{e(L)!==e(xe)&&(s(g,[]),s(xe,e(L)))}),Z(()=>(e(q),e(G),e(g)),()=>{s(ne,e(q).filter(t=>{const i=e(G).toLowerCase(),m=t.provider_symbol.toLowerCase().includes(i)||t.name.toLowerCase().includes(i),F=!e(g).find(w=>w.provider_symbol===t.provider_symbol);return m&&F}).slice(0,50))}),lt(),rt();var he=Ut(),ye=r(he),Fe=r(ye),We=r(Fe,!0);a(Fe),a(ye);var Le=l(ye,2),Ne=r(Le),Re=r(Ne);{var Xe=t=>{var i=Lt(),m=r(i),F=r(m),w=l(r(F),2);p(()=>{e(L),Be(()=>{})});var E=r(w);E.value=E.__value="cnb";var N=l(E);N.value=N.__value="fcs",a(w),a(F);var j=l(F,2),V=l(r(j),2);je(V),a(j);var W=l(j,2),A=l(r(W),2),x=r(A),C=r(x);ie(C,1,()=>e(g),de,(o,d)=>{var h=yt(),J=r(h),X=l(J);a(h),p(()=>_(J,`${e(d),f(()=>e(d).provider_symbol)??""} `)),U("click",X,ct(()=>Ie(e(d)))),n(o,h)});var P=l(C,2);je(P),a(x),a(A);var we=l(A,2);{var me=o=>{var d=Ct(),h=r(d);{var J=z=>{var k=St(),Y=Me(k);ie(Y,1,()=>e(ne),de,(M,S)=>{var O=wt(),le=r(O),oe=r(le),Se=r(oe,!0);a(oe);var Ee=l(oe,2),tt=r(Ee,!0);a(Ee),a(le),a(O),p(()=>{_(Se,(e(S),f(()=>e(S).provider_symbol))),_(tt,(e(S),f(()=>e(S).name)))}),U("mousedown",O,ut(()=>He(e(S)))),n(M,O)});var se=l(Y,2);{var ke=M=>{var S=kt(),O=r(S);a(S),p(()=>_(O,`Type to filter ${e(q),e(g),f(()=>e(q).length-e(g).length)??""} symbols`)),n(M,S)};y(se,M=>{e(q),e(G),f(()=>e(q).length>50&&!e(G))&&M(ke)})}n(z,k)},X=z=>{var k=Bt();n(z,k)};y(h,z=>{e(ne),f(()=>e(ne).length>0)?z(J):z(X,!1)})}a(d),n(o,d)};y(we,o=>{e(ve)&&o(me)})}a(W),a(m);var re=l(m,2),v=l(re,2);{var c=o=>{var d=Pt(),h=r(d,!0);a(d),p(()=>_(h,e(ce))),n(o,d)};y(v,o=>{e(ce)&&o(c)})}var T=l(v,2);{var I=o=>{var d=Tt(),h=r(d,!0);a(d),p(()=>_(h,e(ae))),n(o,d)};y(T,o=>{e(ae)&&o(I)})}var R=l(T,2);{var D=o=>{var d=Ft(),h=l(r(d),2),J=r(h),X=l(r(J));ie(X,5,()=>e(ue),de,(z,k)=>{var Y=$t(),se=r(Y),ke=r(se,!0);a(se);var M=l(se),S=r(M),O=r(S,!0);a(S),a(M);var le=l(M),oe=r(le,!0);a(le),a(Y),p(Se=>{_(ke,(e(k),f(()=>e(k).name))),nt(S,1,`px-2 py-1 rounded text-xs ${e(k),f(()=>e(k).status==="running"?"bg-blue-900 text-blue-300":"bg-slate-700 text-slate-300")??""}`),_(O,(e(k),f(()=>e(k).status))),_(oe,Se)},[()=>(Ce(ee),e(k),f(()=>ee(e(k).last_run)||"-"))]),n(z,Y)}),a(X),a(J),a(h),a(d),n(o,d)};y(R,o=>{e(ue),f(()=>e(ue).length>0)&&o(D)})}a(i),p(()=>vt(P,"placeholder",(e(g),f(()=>e(g).length>0?"":"Search symbols...")))),Pe(w,()=>e(L),o=>s(L,o)),Ae(V,()=>e(ge),o=>s(ge,o)),Ae(P,()=>e(G),o=>s(G,o)),U("focus",P,()=>s(ve,!0)),U("blur",P,()=>setTimeout(()=>s(ve,!1),200)),U("click",re,Je),n(t,i)};y(Re,t=>{e($)==="backfill"&&t(Xe)})}var De=l(Re,2);{var Ye=t=>{var i=Dt(),m=r(i),F=l(r(m),2);p(()=>{e(be),Be(()=>{})});var w=r(F);w.value=w.__value="cnb";var E=l(w);E.value=E.__value="fcs",a(F),a(m);var N=l(m,2),j=l(N,2);{var V=x=>{var C=Nt(),P=r(C,!0);a(C),p(()=>_(P,e(pe))),n(x,C)};y(j,x=>{e(pe)&&x(V)})}var W=l(j,2);{var A=x=>{var C=Rt(),P=r(C,!0);a(C),p(()=>_(P,e(fe))),n(x,C)};y(W,x=>{e(fe)&&x(A)})}a(i),Pe(F,()=>e(be),x=>s(be,x)),U("click",N,Ke),n(t,i)};y(De,t=>{e($)==="symbols"&&t(Ye)})}var Ze=l(De,2);{var et=t=>{var i=Ot(),m=r(i),F=l(r(m),2);a(m);var w=l(m,2),E=l(r(w),2),N=r(E);p(()=>{e(B),Be(()=>{e(K)})});var j=r(N);{var V=v=>{var c=Et();c.value=(c.__value=null)??"",n(v,c)},W=v=>{var c=at(),T=Me(c);ie(T,1,()=>e(K),de,(I,R)=>{var D=Mt(),o=r(D);a(D);var d={};p(h=>{_(o,`${e(R),f(()=>e(R).filename)??""} (${h??""})`),d!==(d=e(R))&&(D.value=(D.__value=e(R))??"")},[()=>(Ce(ee),e(R),f(()=>ee(e(R).timestamp)))]),n(I,D)}),n(v,c)};y(j,v=>{e(K),f(()=>e(K).length===0)?v(V):v(W,!1)})}a(N);var A=l(N,2);a(E),a(w);var x=l(w,2);{var C=v=>{var c=jt(),T=r(c,!0);a(c),p(()=>_(T,e(Q))),n(v,c)};y(x,v=>{e(Q)&&v(C)})}var P=l(x,2);{var we=v=>{var c=At(),T=r(c,!0);a(c),p(()=>_(T,e(H))),n(v,c)};y(P,v=>{e(H)&&v(we)})}var me=l(P,2),re=l(r(me),2);ie(re,5,()=>e(K),de,(v,c)=>{var T=zt(),I=r(T),R=r(I,!0);a(I);var D=l(I,2),o=r(D,!0);a(D),a(T),p(d=>{_(R,(e(c),f(()=>e(c).filename))),_(o,d)},[()=>(Ce(ee),e(c),f(()=>ee(e(c).timestamp)))]),n(v,T)}),a(re),a(me),a(i),p(()=>A.disabled=!e(B)),U("click",F,Qe),Pe(N,()=>e(B),v=>s(B,v)),U("click",A,Ve),n(t,i)};y(Ze,t=>{e($)==="backups"&&t(et)})}a(Ne),a(Le),a(he),p(t=>_(We,t),[()=>(e($),f(()=>e($).charAt(0).toUpperCase()+e($).slice(1)))]),n(ze,he),ot(),qe()}export{ea as component};
