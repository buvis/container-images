import{a as c,f as p,s as Y,e as pe}from"../chunks/BGC_O7Cu.js";import{i as V}from"../chunks/CxezgJRR.js";import{p as X,o as Z,g as e,s as f,a1 as me,l as K,e as L,a2 as be,a as _e,c as n,r as l,b as ee,m as u,d as D,t as z,h as k}from"../chunks/D8SkQY_2.js";import{i as j}from"../chunks/CCe7VU-t.js";import{e as B,i as E,s as Q}from"../chunks/BM-OiPN0.js";import{k as ge,h as ue,e as ye}from"../chunks/sCxhiejC.js";import{b as he}from"../chunks/B_sgX0IR.js";import{p as U}from"../chunks/D5vEBnig.js";import{C as xe}from"../chunks/sRkgK8jz.js";var we=p('<div class="h-16 w-32"><canvas></canvas></div>');function De(S,C){X(C,!1);const v=u();let y=U(C,"data",24,()=>[]),b=U(C,"color",8,"#3b82f6"),_=u(),a=u();const F={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,mode:"index",intersect:!1}},scales:{x:{display:!1},y:{display:!1}},interaction:{mode:"nearest",axis:"x",intersect:!1}};Z(()=>{e(_)&&f(a,new xe(e(_),{type:"line",data:e(v),options:F}))}),me(()=>{e(a)&&e(a).destroy()}),K(()=>(L(y()),L(b())),()=>{f(v,{labels:y().map(g=>g.date),datasets:[{fill:!0,data:y().map(g=>g.rate),borderColor:b(),backgroundColor:b()+"20",borderWidth:2,pointRadius:0,tension:.4}]})}),K(()=>(e(a),e(v)),()=>{e(a)&&e(v)&&(be(a,e(a).data=e(v)),e(a).update("none"))}),_e(),V();var h=we(),$=n(h);he($,g=>f(_,g),()=>e(_)),l(h),c(S,h),ee()}var ke=p("<button> </button>"),Ce=p('<div class="bg-slate-900 p-6 rounded-xl border border-slate-800 animate-pulse h-32"></div>'),Re=p('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>'),Fe=p("<div> </div>"),Me=p('<div class="h-16 flex items-center justify-center text-slate-600 text-sm">No Data</div>'),Ye=p('<div class="bg-slate-900 p-6 rounded-xl border border-slate-800 hover:border-slate-700 transition-colors"><div class="flex justify-between items-start mb-4"><div><h3 class="text-lg font-bold text-white"> </h3> <p class="text-sm text-slate-400"> </p></div> <!></div> <!></div>'),je=p('<div class="col-span-full p-8 text-center text-slate-500 border border-dashed border-slate-800 rounded-xl">No favorites added yet.</div>'),Se=p('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"><!> <!></div>'),$e=p('<div class="bg-slate-950 text-slate-100 p-8"><header class="flex items-center justify-between mb-8"><h1 class="text-3xl font-bold text-white">Market</h1> <div class="flex bg-slate-900 rounded-lg p-1"></div></header> <!></div>');function ze(S,C){X(C,!1);let v=u([]),y=u({}),b=u(!0);const _=[{label:"7D",days:7},{label:"30D",days:30},{label:"3M",days:90},{label:"6M",days:180},{label:"1Y",days:365},{label:"3Y",days:1095},{label:"5Y",days:1825},{label:"10Y",days:3650}];let a=u(7);function F(t){return t.toISOString().split("T")[0]}async function h(t){const s=new Date,i=new Date;i.setDate(s.getDate()-t);const x=e(v).map(async r=>{const m=await ye(r.provider_symbol,F(i),F(s),r.provider,r.provider_symbol);return{key:`${r.provider}:${r.provider_symbol}`,history:m}}),R=await Promise.all(x);f(y,R.reduce((r,{key:m,history:N})=>(r[m]=N,r),{}))}async function $(t){f(a,t),f(b,!0),await h(t),f(b,!1)}async function g(){try{const t=await ge();f(a,t.dashboard_history_days),f(v,await ue()),await h(e(a))}catch(t){console.error("Failed to load market data",t)}finally{f(b,!1)}}Z(()=>{g()}),V();var A=$e(),H=n(A),G=D(n(H),2);B(G,5,()=>_,E,(t,s)=>{var i=ke(),x=n(i,!0);l(i),z(()=>{Q(i,1,`px-3 py-1 text-xs font-medium rounded transition-colors ${e(a)===e(s).days?"bg-slate-700 text-white shadow":"text-slate-400 hover:text-slate-200"}`),Y(x,e(s).label)}),pe("click",i,()=>$(e(s).days)),c(t,i)}),l(G),l(H);var te=D(H,2);{var ae=t=>{var s=Re();B(s,4,()=>Array(6),E,(i,x)=>{var R=Ce();c(i,R)}),l(s),c(t,s)},se=t=>{var s=Se(),i=n(s);B(i,1,()=>e(v),E,(r,m)=>{const N=k(()=>`${e(m).provider}:${e(m).provider_symbol}`),d=k(()=>e(y)[e(N)]);var P=Ye(),T=n(P),q=n(T),I=n(q),re=n(I,!0);l(I);var J=D(I,2),oe=n(J);l(J),l(q);var ie=D(q,2);{var le=o=>{const w=k(()=>e(d)[e(d).length-1].rate),O=k(()=>e(d)[0].rate),W=k(()=>e(w)&&e(O)?(e(w)-e(O))/e(O)*100:0);var M=Fe(),ce=n(M);l(M),z(fe=>{Q(M,1,`text-sm font-bold ${e(W)>=0?"text-green-400":"text-red-400"}`),Y(ce,`${e(W)>0?"+":""}${fe??""}%`)},[()=>e(W).toFixed(2)]),c(o,M)};j(ie,o=>{e(d)&&e(d).length>0&&o(le)})}l(T);var de=D(T,2);{var ne=o=>{{let w=k(()=>e(d).length>1&&(e(d)[e(d).length-1].rate||0)>=(e(d)[0].rate||0)?"#4ade80":"#f87171");De(o,{get data(){return e(d)},get color(){return e(w)}})}},ve=o=>{var w=Me();c(o,w)};j(de,o=>{e(d)?o(ne):o(ve,!1)})}l(P),z(o=>{Y(re,e(m).provider_symbol),Y(oe,`${o??""} Trend`)},[()=>_.find(o=>o.days===e(a))?.label||e(a)+"D"]),c(r,P)});var x=D(i,2);{var R=r=>{var m=je();c(r,m)};j(x,r=>{e(v).length===0&&r(R)})}l(s),c(t,s)};j(te,t=>{e(b)?t(ae):t(se,!1)})}l(A),c(S,A),ee()}export{ze as component};
