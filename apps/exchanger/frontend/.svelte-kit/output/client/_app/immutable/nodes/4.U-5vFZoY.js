import{a as x,f as _,c as Mt,s as h,e as Rt,b as Ut}from"../chunks/BGC_O7Cu.js";import{i as Xt}from"../chunks/CxezgJRR.js";import{p as Zt,m as c,o as te,l as $,a as ee,g as t,b as ae,c as l,s as o,d as f,r,f as $t,u as a,t as Q,e as re,h as se,j as jt,k as Pt}from"../chunks/D8SkQY_2.js";import{i as at}from"../chunks/CCe7VU-t.js";import{e as U,i as X,s as Ct}from"../chunks/BM-OiPN0.js";import{r as le,s as m}from"../chunks/1CmXKqvd.js";import{s as oe}from"../chunks/BuT9soB4.js";import{b as ie}from"../chunks/DupA02UL.js";import{d as de,e as ve,f as ne}from"../chunks/sCxhiejC.js";import{C as ce}from"../chunks/hMDAKPhK.js";var fe=_('<div class="h-12 bg-slate-800 rounded animate-pulse"></div>'),ue=_('<div class="space-y-2"></div>'),me=_('<p class="text-slate-500 text-center py-4">No multi-provider symbols found.</p>'),xe=_('<button><div class="font-mono font-bold"> </div> <div class="text-xs text-slate-500"> </div></button>'),be=_('<div class="space-y-1 max-h-[50vh] overflow-y-auto"></div>'),pe=_('<div class="bg-slate-900 rounded-xl border border-slate-800 p-8 text-center text-slate-500">Select a symbol to compare rates across providers.</div>'),_e=_('<div class="bg-slate-900 rounded-xl border border-slate-800 p-8"><div class="h-64 flex items-center justify-center text-slate-500">Loading rate history...</div></div>'),ye=_("<button> </button>"),he=Ut('<path fill="none" stroke-width="2"></path>'),ge=_('<div class="flex items-center gap-3 p-3 bg-slate-800 rounded-lg"><div class="w-3 h-3 rounded-full flex-shrink-0"></div> <div class="min-w-0 flex-1"><div class="text-sm font-medium text-white"> </div> <div class="text-xs text-slate-500 truncate"> </div></div> <div class="text-right"><div class="font-mono text-white"> </div></div></div>'),we=_('<div class="bg-slate-900 rounded-xl border border-slate-800 p-6"><div class="flex items-center justify-between mb-6"><h2 class="text-xl font-bold text-white"> </h2> <div class="flex bg-slate-800 rounded-lg p-1"></div></div> <div class="mb-6"><svg class="w-full h-auto"><text text-anchor="end" class="fill-slate-500 text-xs"> </text><text text-anchor="end" class="fill-slate-500 text-xs"> </text><line stroke="#334155" stroke-dasharray="4"></line><line stroke="#334155" stroke-dasharray="4"></line><!></svg></div> <div class="mb-2 text-xs text-slate-500"> </div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div></div>'),Se=_('<div class="bg-slate-950 text-slate-200 p-6"><header class="mb-8"><h1 class="text-3xl font-bold text-white">Compare</h1></header> <div class="flex flex-col lg:flex-row gap-6"><div class="w-full lg:w-80 flex-shrink-0 flex flex-col gap-4"><!> <div class="bg-slate-900 rounded-xl border border-slate-800 p-4"><input type="text" placeholder="Search symbols..." class="w-full px-3 py-2 mb-4 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-slate-500"/> <!></div></div> <div class="flex-1"><!></div></div></div>');function He(Lt,Ft){Zt(Ft,!1);const Z=c(),rt=c(),j=c(),K=c(),N=c(),T=c(),B=c(),I=c();let st=c([]),P=c(null),xt=[],bt=c(!0),C=c(!1),q=c(""),L=c(new Date().toISOString().split("T")[0]),k=c({});const Ht=[{label:"7D",days:7},{label:"30D",days:30},{label:"3M",days:90},{label:"1Y",days:365},{label:"3Y",days:1095},{label:"5Y",days:1825},{label:"10Y",days:3650}];let tt=c(30);te(async()=>{try{o(st,await de())}catch(e){console.error("Failed to load multi-provider symbols",e)}finally{o(bt,!1)}});async function Ot(e){o(P,e),o(C,!0),o(k,{});try{xt=await ne(e),await lt()}catch(i){console.error("Failed to load symbol variants",i)}finally{o(C,!1)}}async function lt(){const e=new Date(t(L)+"T00:00:00"),i=new Date(e);i.setDate(e.getDate()-t(tt));const g=i.toISOString().split("T")[0],F=t(L),w=xt.map(async s=>{const n=await ve(s.symbol,g,F,s.provider,s.provider_symbol);return{variantKey:`${s.provider}:${s.provider_symbol}`,provider:s.provider,providerSymbol:s.provider_symbol,history:n}}),v=await Promise.all(w);o(k,v.reduce((s,n)=>(s[n.variantKey]={provider:n.provider,providerSymbol:n.providerSymbol,history:n.history},s),{}))}async function Yt(e){o(tt,e),t(P)&&(o(C,!0),await lt(),o(C,!1))}async function Kt(e){o(L,e.detail),t(P)&&(o(C,!0),await lt(),o(C,!1))}function ot(e){return e===null?"-":e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:6})}const it=600,z=200,d={top:20,right:20,bottom:30,left:60};function Nt(e,i,g){if(e.filter(b=>b.rate!==null).length<2)return"";const w=(it-d.left-d.right)/(e.length-1),v=g-i||1,s=(z-d.top-d.bottom)/v;let n="",u=!1;return e.forEach((b,M)=>{if(b.rate===null)return;const R=d.left+M*w,S=z-d.bottom-(b.rate-i)*s;u?n+=` L ${R} ${S}`:(n+=`M ${R} ${S}`,u=!0)}),n}const et=["#22d3ee","#a78bfa","#f472b6","#4ade80","#fb923c"];$(()=>(t(st),t(q)),()=>{o(Z,t(st).filter(e=>!t(q)||e.symbol.toLowerCase().includes(t(q).toLowerCase())))}),$(()=>t(k),()=>{o(rt,Object.values(t(k)).flatMap(e=>e.history))}),$(()=>t(rt),()=>{o(j,t(rt).map(e=>e.rate).filter(e=>e!==null))}),$(()=>t(j),()=>{o(K,t(j).length?Math.min(...t(j)):0)}),$(()=>t(j),()=>{o(N,t(j).length?Math.max(...t(j)):1)}),$(()=>(t(N),t(K)),()=>{o(T,t(N)-t(K)||1)}),$(()=>(t(K),t(T)),()=>{o(B,t(K)-t(T)*.05)}),$(()=>(t(N),t(T)),()=>{o(I,t(N)+t(T)*.05)}),ee(),Xt();var dt=Se(),pt=f(l(dt),2),vt=l(pt),_t=l(vt);ce(_t,{get selectedDate(){return t(L)},$$events:{change:Kt}});var yt=f(_t,2),nt=l(yt);le(nt);var Tt=f(nt,2);{var Bt=e=>{var i=ue();U(i,4,()=>Array(5),X,(g,F)=>{var w=fe();x(g,w)}),r(i),x(e,i)},It=e=>{var i=Mt(),g=$t(i);{var F=v=>{var s=me();x(v,s)},w=v=>{var s=be();U(s,5,()=>t(Z),X,(n,u)=>{var b=xe(),M=l(b),R=l(M,!0);r(M);var S=f(M,2),H=l(S,!0);r(S),r(b),Q(ct=>{Ct(b,1,`w-full text-left px-3 py-2 rounded-lg transition-colors ${t(P),t(u),a(()=>t(P)===t(u).symbol?"bg-slate-700 text-white":"hover:bg-slate-800 text-slate-300")??""}`),h(R,(t(u),a(()=>t(u).symbol))),h(H,ct)},[()=>(t(u),a(()=>t(u).providers.join(", ")))]),Rt("click",b,()=>Ot(t(u).symbol)),x(n,b)}),r(s),x(v,s)};at(g,v=>{t(Z),a(()=>t(Z).length===0)?v(F):v(w,!1)},!0)}x(e,i)};at(Tt,e=>{t(bt)?e(Bt):e(It,!1)})}r(yt),r(vt);var ht=f(vt,2),qt=l(ht);{var zt=e=>{var i=pe();x(e,i)},At=e=>{var i=Mt(),g=$t(i);{var F=v=>{var s=_e();x(v,s)},w=v=>{var s=we(),n=l(s),u=l(n),b=l(u,!0);r(u);var M=f(u,2);U(M,5,()=>Ht,X,(O,p)=>{var D=ye(),W=l(D,!0);r(D),Q(()=>{Ct(D,1,`px-3 py-1 text-xs font-medium rounded transition-colors ${t(tt),t(p),a(()=>t(tt)===t(p).days?"bg-slate-700 text-white":"text-slate-400 hover:text-slate-200")??""}`),h(W,(t(p),a(()=>t(p).label)))}),Rt("click",D,()=>Yt(t(p).days)),x(O,D)}),r(M),r(n);var R=f(n,2),S=l(R);m(S,"viewBox","0 0 600 200");var H=l(S),ct=l(H,!0);r(H);var A=f(H),Et=l(A,!0);r(A);var E=f(A),V=f(E),Vt=f(V);U(Vt,1,()=>(t(k),a(()=>Object.entries(t(k)))),X,(O,p,D)=>{var W=jt(()=>Pt(t(p),2));let y=()=>t(W)[1];var Y=he();Q(G=>{m(Y,"d",G),m(Y,"stroke",a(()=>et[D%et.length]))},[()=>(y(),t(B),t(I),a(()=>Nt(y().history,t(B),t(I))))]),x(O,Y)}),r(S),r(R);var ft=f(R,2),Wt=l(ft);r(ft);var gt=f(ft,2);U(gt,5,()=>(t(k),a(()=>Object.entries(t(k)))),X,(O,p,D)=>{var W=jt(()=>Pt(t(p),2));let y=()=>t(W)[1];const Y=se(()=>(y(),t(L),a(()=>y().history.find(J=>J.date===t(L))?.rate??y().history.findLast(J=>J.rate!==null)?.rate)));var G=ge(),wt=l(G),ut=f(wt,2),mt=l(ut),Gt=l(mt,!0);r(mt);var St=f(mt,2),Jt=l(St,!0);r(St),r(ut);var Dt=f(ut,2),kt=l(Dt),Qt=l(kt,!0);r(kt),r(Dt),r(G),Q(J=>{oe(wt,`background-color: ${a(()=>et[D%et.length])??""}`),h(Gt,(y(),a(()=>y().provider))),h(Jt,(y(),a(()=>y().providerSymbol))),h(Qt,J)},[()=>(re(t(Y)),a(()=>ot(t(Y)??null)))]),x(O,G)}),r(gt),r(s),Q((O,p)=>{h(b,t(P)),m(H,"x",a(()=>d.left-10)),m(H,"y",a(()=>d.top)),h(ct,O),m(A,"x",a(()=>d.left-10)),m(A,"y",a(()=>z-d.bottom)),h(Et,p),m(E,"x1",a(()=>d.left)),m(E,"y1",a(()=>d.top)),m(E,"x2",a(()=>it-d.right)),m(E,"y2",a(()=>d.top)),m(V,"x1",a(()=>d.left)),m(V,"y1",a(()=>z-d.bottom)),m(V,"x2",a(()=>it-d.right)),m(V,"y2",a(()=>z-d.bottom)),h(Wt,`Rates for ${t(L)??""}`)},[()=>(t(I),a(()=>ot(t(I)))),()=>(t(B),a(()=>ot(t(B))))]),x(v,s)};at(g,v=>{t(C)?v(F):v(w,!1)},!0)}x(e,i)};at(qt,e=>{t(P)?e(At,!1):e(zt)})}r(ht),r(pt),r(dt),ie(nt,()=>t(q),e=>o(q,e)),x(Lt,dt),ae()}export{He as component};
