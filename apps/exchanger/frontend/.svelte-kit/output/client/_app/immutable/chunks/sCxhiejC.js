const r="/api";function u(t){const e=t.indexOf("/");return e!==-1&&e<t.length-1?t.slice(e+1):t.length>3?t.slice(-3):t}async function s(t,e){const n=await fetch(t,e);if(!n.ok){let a;try{const o=await n.json();typeof o.detail=="string"?a=o.detail:Array.isArray(o.detail)?a=o.detail.map(c=>c.msg??"").join("; "):o.detail&&(a=JSON.stringify(o.detail))}catch{}throw new Error(a??`API request failed: ${n.status} ${n.statusText}`)}return n.json()}async function p(){return s(`${r}/symbols/list`)}async function f(){return s(`${r}/symbols/multi-provider`)}async function d(t){return s(`${r}/symbols/by-normalized/${encodeURIComponent(t)}`)}async function l(){return s(`${r}/health`)}async function y(){return s(`${r}/config`)}async function m(){const t=await s(`${r}/task_status`);return Object.entries(t).map(([e,n])=>({name:e,...n}))}async function g(t,e,n="all"){const a=new URLSearchParams({date:t,symbol:e,provider:n});return s(`${r}/rates?${a.toString()}`)}async function $(t,e,n){const a=new URLSearchParams({date:t,provider:e??"all"}),o=await s(`${r}/rates/list?${a.toString()}`);return(n?o.filter(i=>i.type===n):o).map(i=>({symbol:i.symbol,base:u(i.provider_symbol),date:t,rate:i.rate,provider:i.provider,type:i.type,provider_symbol:i.provider_symbol}))}async function h(t,e,n,a,o){const c=new URLSearchParams({symbol:t,from_date:e,to_date:n});return a&&c.append("provider",a),o&&c.append("provider_symbol",o),s(`${r}/rates/history?${c.toString()}`)}async function S(t,e,n){const a=new URLSearchParams({year:t.toString()});return n?.length&&a.append("symbols",n.join(",")),s(`${r}/rates/coverage?${a.toString()}`)}async function v(t,e,n){if(!e.length)return{};const a=new URLSearchParams({year:t.toString(),symbols:e.join(",")});return s(`${r}/rates/missing?${a.toString()}`)}async function b(){return s(`${r}/favorites`)}async function w(t,e){await s(`${r}/favorites`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:t,provider_symbol:e})})}async function P(t,e){await s(`${r}/favorites/${encodeURIComponent(t)}/${encodeURIComponent(e)}`,{method:"DELETE"})}async function R(){return s(`${r}/providers/status`)}async function _(t,e,n){const a=new URLSearchParams({provider:t,length:e.toString()});return n?.length&&a.append("symbols",n.join(",")),s(`${r}/backfill?${a.toString()}`,{method:"POST"})}async function U(t){await s(`${r}/populate_symbols?provider=${encodeURIComponent(t)}`,{method:"POST"})}async function k(){return s(`${r}/backups`)}async function j(){return s(`${r}/backup`,{method:"POST"})}async function C(t){await s(`${r}/restore?timestamp=${encodeURIComponent(t)}`,{method:"POST"})}async function O(t,e,n,a,o,c){const i=new URLSearchParams({date:t,from_currency:e,intermediate:n,to_currency:a,from_provider:o,to_provider:c});return s(`${r}/rates/chain?${i.toString()}`)}export{m as a,p as b,j as c,f as d,h as e,d as f,k as g,b as h,g as i,O as j,y as k,R as l,P as m,w as n,$ as o,U as p,l as q,C as r,S as s,_ as t,v as u};
