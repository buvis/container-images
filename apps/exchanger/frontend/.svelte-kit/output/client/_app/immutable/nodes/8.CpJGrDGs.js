import{d as se,a as w,f as R,s as U,e as W,c as oe}from"../chunks/BGC_O7Cu.js";import{i as Z}from"../chunks/CxezgJRR.js";import{p as J,b as Q,r as n,g as e,c,t as q,j as ie,a3 as ae,m as y,l as N,a as ee,e as k,u as M,d as D,s,o as le,a1 as ne,a2 as de,f as ve}from"../chunks/D8SkQY_2.js";import{o as ce,h as fe,m as ue,n as ge,e as be}from"../chunks/sCxhiejC.js";import{C as ye}from"../chunks/hMDAKPhK.js";import{e as te,i as re,s as G}from"../chunks/BM-OiPN0.js";import{p as I}from"../chunks/D5vEBnig.js";import{S as pe}from"../chunks/BMPKrKFN.js";import{i as X}from"../chunks/CCe7VU-t.js";import{s as me}from"../chunks/BuT9soB4.js";import{b as he}from"../chunks/B_sgX0IR.js";import{C as xe}from"../chunks/sRkgK8jz.js";var _e=R('<button type="button"> </button>'),we=R('<div class="flex bg-slate-900 rounded-lg p-1 border border-slate-700"></div>');function Se(Y,u){J(u,!0);let h=I(u,"value",15,"");function x(i){return typeof i=="string"?i.charAt(0).toUpperCase()+i.slice(1):i.label}function f(i){return typeof i=="string"?i:i.value}var g=we();te(g,21,()=>u.options,re,(i,p)=>{const v=ie(()=>f(e(p)));var l=_e();l.__click=()=>h(e(v));var S=c(l,!0);n(l),q(L=>{G(l,1,`px-4 py-1.5 text-sm font-medium rounded transition-colors ${h()===e(v)?"bg-slate-700 text-white":"text-slate-400 hover:text-slate-200"}`),U(S,L)},[()=>x(e(p))]),w(i,l)}),n(g),w(Y,g),Q()}se(["click"]);var Ce=R('<div role="button" tabindex="0"><span class="font-bold text-slate-200"> </span> <div class="flex items-center gap-3"><span class="font-mono text-slate-300"> </span> <button class="text-slate-500 hover:text-yellow-400 transition-colors p-1" aria-label="Toggle favorite"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></button></div></div>'),ke=R('<div class="text-center text-slate-500 py-4 text-sm">No rates found</div>'),De=R('<div class="bg-slate-800 rounded-lg shadow-lg flex flex-col h-full overflow-hidden border border-slate-700"><div class="p-4 border-b border-slate-700 space-y-3"><!> <!></div> <div class="flex-1 overflow-y-auto p-2 space-y-1"></div></div>');function Re(Y,u){J(u,!1);const h=y(),x=y();let f=I(u,"rates",24,()=>[]),g=I(u,"favorites",24,()=>[]),i=I(u,"selectedSymbol",8,null),p=I(u,"activeType",12,"forex");const v=ae();let l=y(""),S=y(p());function L(r,d){r.stopPropagation(),v("toggleFavorite",{provider:d.provider,provider_symbol:d.provider_symbol})}function P(r){return e(h).has(`${r.provider}:${r.provider_symbol}`)}N(()=>(k(p()),e(S)),()=>{p()!==e(S)&&(v("typeChange",p()),s(S,p()))}),N(()=>k(g()),()=>{s(h,new Set(g().map(r=>`${r.provider}:${r.provider_symbol}`)))}),N(()=>(k(f()),e(l)),()=>{s(x,f().filter(r=>r.symbol.toLowerCase().includes(e(l).toLowerCase())))}),ee(),Z();var T=De(),C=c(T),j=c(C);Se(j,{options:["forex","crypto"],get value(){return p()},set value(r){p(r)},$$legacy:!0});var B=D(j,2);pe(B,{placeholder:"Search symbol...",get value(){return e(l)},set value(r){s(l,r)},$$legacy:!0}),n(C);var $=D(C,2);te($,5,()=>e(x),r=>r.provider_symbol,(r,d)=>{var F=Ce(),_=c(F),z=c(_,!0);n(_);var H=D(_,2),O=c(H),V=c(O,!0);n(O);var A=D(O,2),a=c(A);n(A),n(H),n(F),q((o,t)=>{G(F,1,`w-full flex items-center justify-between p-2 rounded hover:bg-slate-700 transition-colors group cursor-pointer ${k(i()),e(d),M(()=>i()===e(d).symbol?"bg-slate-700 ring-1 ring-slate-500":"")??""}`),U(z,(e(d),M(()=>e(d).symbol))),U(V,o),G(a,0,`h-5 w-5 ${t??""}`)},[()=>(e(d),M(()=>e(d).rate.toFixed(4))),()=>(e(d),M(()=>P(e(d))?"text-yellow-400 fill-current":"fill-none stroke-current"))]),W("click",A,o=>L(o,e(d))),W("click",F,()=>v("select",e(d).symbol)),W("keydown",F,o=>o.key==="Enter"&&v("select",e(d).symbol)),w(r,F)},r=>{var d=ke();w(r,d)}),n($),n(T),w(Y,T),Q()}var Fe=R("<button> </button>"),Te=R('<div class="absolute inset-0 flex items-center justify-center bg-slate-800/50 z-10"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div></div>'),je=R('<div class="absolute inset-0 flex items-center justify-center text-slate-500">Select a symbol to view history</div>'),Ie=R('<div class="absolute inset-0 flex items-center justify-center text-slate-500">No data available</div>'),Le=R('<div class="bg-slate-800 rounded-lg shadow-lg p-4 h-full flex flex-col border border-slate-700"><div class="flex justify-between items-center mb-4"><h2 class="text-xl font-bold text-slate-200"> </h2> <div class="flex bg-slate-900 rounded-lg p-1"></div></div> <div class="flex-1 relative min-h-[300px]"><!> <div class="w-full h-full"><canvas></canvas></div> <!></div></div>');function He(Y,u){J(u,!1);const h=y();let x=I(u,"symbol",8,null),f=I(u,"history",24,()=>[]),g=I(u,"isLoading",8,!1),i=I(u,"activeRange",8,"30d");const p=ae();let v=y(),l=y();const S=[{label:"7D",value:"7d",days:7},{label:"30D",value:"30d",days:30},{label:"3M",value:"3m",days:90},{label:"6M",value:"6m",days:180},{label:"1Y",value:"1y",days:365},{label:"3Y",value:"3y",days:1095},{label:"5Y",value:"5y",days:1825},{label:"10Y",value:"10y",days:3650}];function L(a){const o=new Date,t=new Date;t.setDate(o.getDate()-a.days);const b=o.toISOString().split("T")[0],m=t.toISOString().split("T")[0];p("rangeChange",{from:m,to:b,range:a.value,days:a.days})}const P={responsive:!0,maintainAspectRatio:!1,scales:{x:{grid:{color:"rgba(148, 163, 184, 0.1)"},ticks:{color:"#94a3b8"}},y:{grid:{color:"rgba(148, 163, 184, 0.1)"},ticks:{color:"#94a3b8"}}},plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(15, 23, 42, 0.9)",titleColor:"#f1f5f9",bodyColor:"#cbd5e1",borderColor:"#334155",borderWidth:1}},interaction:{mode:"nearest",axis:"x",intersect:!1}};le(()=>{e(v)&&s(l,new xe(e(v),{type:"line",data:e(h),options:P}))}),ne(()=>{e(l)&&e(l).destroy()}),N(()=>(k(f()),k(x())),()=>{s(h,{labels:f().map(a=>a.date),datasets:[{label:x()||"Rate",fill:!0,tension:.3,backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"rgb(59, 130, 246)",pointRadius:0,pointHitRadius:10,data:f().map(a=>a.rate)}]})}),N(()=>(e(l),e(h)),()=>{e(l)&&e(h)&&(de(l,e(l).data=e(h)),e(l).update("none"))}),ee(),Z();var T=Le(),C=c(T),j=c(C),B=c(j,!0);n(j);var $=D(j,2);te($,5,()=>S,re,(a,o)=>{var t=Fe(),b=c(t,!0);n(t),q(()=>{G(t,1,`px-3 py-1 text-xs font-medium rounded transition-colors ${k(i()),e(o),M(()=>i()===e(o).value?"bg-slate-700 text-white shadow":"text-slate-400 hover:text-slate-200")??""}`),U(b,(e(o),M(()=>e(o).label)))}),W("click",t,()=>L(e(o))),w(a,t)}),n($),n(C);var r=D(C,2),d=c(r);{var F=a=>{var o=Te();w(a,o)};X(d,a=>{g()&&a(F)})}var _=D(d,2);let z;var H=c(_);he(H,a=>s(v,a),()=>e(v)),n(_);var O=D(_,2);{var V=a=>{var o=je();w(a,o)},A=a=>{var o=oe(),t=ve(o);{var b=m=>{var E=Ie();w(m,E)};X(t,m=>{k(f()),k(g()),M(()=>f().length===0&&!g())&&m(b)},!0)}w(a,o)};X(O,a=>{x()?a(A,!1):a(V)})}n(r),n(T),q(()=>{U(B,x()?`${x()} History`:"Select a symbol"),z=me(_,"",z,{display:(k(x()),k(f()),M(()=>x()&&f().length>0?"block":"none"))})}),w(Y,T),Q()}var Oe=R('<div class="bg-slate-950 text-slate-200 p-6 flex flex-col gap-6"><header class="mb-4"><h1 class="text-3xl font-bold text-white">Rates</h1></header> <div class="flex flex-col lg:flex-row gap-6 flex-1 min-h-0"><div class="w-full lg:w-96 flex flex-col gap-6"><!> <div class="flex-1 min-h-[400px]"><!></div></div> <div class="flex-1 min-h-[500px]"><!></div></div></div>');function We(Y,u){J(u,!1);const h=y(),x=y();let f=y(new Date().toISOString().split("T")[0]),g=y(null),i=y("forex"),p=y([]),v=y([]),l=y([]),S=y(!1),L=y("30d"),P=30;le(async()=>{await T(),await C()});async function T(){try{s(v,await fe())}catch(t){console.error("Failed to load favorites",t)}}async function C(){try{s(p,await ce(e(f),e(h),e(i)))}catch(t){console.error("Failed to load rates",t),s(p,[])}}async function j(t,b){if(e(g)){if(s(S,!0),!t||!b){const m=new Date,E=new Date;E.setDate(m.getDate()-P),b=m.toISOString().split("T")[0],t=E.toISOString().split("T")[0]}try{s(l,await be(e(g),t,b,e(h)))}catch(m){console.error("Failed to load history",m),s(l,[])}s(S,!1)}}function B(t){const b=t.detail;e(x),s(f,b),C()}function $(t){s(i,t.detail),s(g,null),s(l,[]),setTimeout(()=>{C()},0)}function r(t){s(g,t.detail),j()}async function d(t){const{provider:b,provider_symbol:m}=t.detail;try{e(v).find(K=>K.provider===b&&K.provider_symbol===m)?(await ue(b,m),s(v,e(v).filter(K=>!(K.provider===b&&K.provider_symbol===m)))):(await ge(b,m),s(v,[...e(v),{provider:b,provider_symbol:m}]))}catch(E){console.error("Failed to toggle favorite",E)}}function F(t){s(L,t.detail.range),P=t.detail.days,j(t.detail.from,t.detail.to)}N(()=>e(i),()=>{s(h,e(i)==="crypto"?"fcs":"cnb")}),N(()=>e(f),()=>{s(x,parseInt(e(f).split("-")[0]))}),ee(),Z();var _=Oe(),z=D(c(_),2),H=c(z),O=c(H);ye(O,{get selectedDate(){return e(f)},$$events:{change:B}});var V=D(O,2),A=c(V);Re(A,{get rates(){return e(p)},get favorites(){return e(v)},get selectedSymbol(){return e(g)},get activeType(){return e(i)},$$events:{select:r,toggleFavorite:d,typeChange:$}}),n(V),n(H);var a=D(H,2),o=c(a);He(o,{get symbol(){return e(g)},get history(){return e(l)},get isLoading(){return e(S)},get activeRange(){return e(L)},$$events:{rangeChange:F}}),n(a),n(z),n(_),w(Y,_),Q()}export{We as component};
